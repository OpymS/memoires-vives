<!DOCTYPE html>
<html lang="fr" xmlns:th="http://www.thymeleaf.org">

<head th:replace="~{fragments/fragment-head :: head(
	'Partagez la mémoire locale de votre région - ' + ${country} + '| Mémoires vives',
	'Découvrez et partagez des souvenirs locaux de ' + ${country},
	'index, follow',
	${canonicalUrl},
	~{fragments/fragment-extra-head::geoMemHead}
)}">
</head>

<body id="body" th:data-authenticated="${#authentication.principal != 'anonymousUser'}"
	class="min-h-screen flex flex-col">
	<div th:replace="~{fragments/fragment-header :: header}"></div>
	<main class="w-full flex-grow flex flex-col items-center">
		<nav class="w-full flex justify-start" aria-label="breadcrumb">
			<ol class="flex flex-wrap items-center text-sm text-gray-600">
				<li class="flex items-center">
					<a th:href="@{/}">Accueil</a> 
				</li>
				<li class="flex items-center">
					<span class="mx-2 text-gray-400">/</span>
					<a th:href="@{/memories/{countrySlug} (countrySlug=${countrySlug})}" th:text="${country}"></a>
				</li>
				<li class="flex items-center" th:unless="${city == null}">
					<span class="mx-2 text-gray-400">/</span>
					<span th:text="${city}"></span>
				</li>	
			</ol>
		</nav>
		<h1 class="h1-title">Souvenirs de <span th:unless="${city == null}" th:text="${city} + ' - '"></span><span
				th:text="${country}"></span></h1>
		<div id="filters-container"
			class="bg-[#bddab2] border border-[#7e9076] text-black rounded-lg w-full lg:w-4/5 h-auto mt-4 flex flex-col items-center gap-2 px-4 pb-4">
			<div class="mt-3 flex sm:pb-2 flex-row gap-10 w-full justify-end">
				<h2 class="h2-title text-black text-center">Filtrer les souvenirs</h2>
				<button id="reset"
					class="bg-white border border-[#7e9076] rounded hover:opacity-60 cursor-pointer w-[30px] h-[30px] text-xl hover:bg-[#7e9076] focus:border-[#7e9076] focus:outline-none focus:ring focus:ring-[#7e9076]">&olarr;</button>
			</div>
			<div class="flex flex-col md:flex-row md:flex-wrap justify-between gap-6 w-full">
				<input type="hidden" id="country-input" th:value="${countrySlug}" />
				<input type="hidden" id="city-input" th:value="${citySlug}" />
				<div id="key-word-container" class="flex flex-col h-[50px] justify-between">
					<div>
						<label for="key-word-input" class="form-label">Recherche par mots clés</label>
						<input id="only-title" type="checkbox" name="only-title" class="ml-3 accent-[#7e9076]" />
						<label for="only-title" class="font-light text-sm">Uniquement dans le titre</label>
					</div>
					<input id="key-word-input" type="text" name="key-word-input"
						placeholder="Séparez les mots par une virgule…" class="filter-input" />
				</div>
				<div id="date-container" class="flex flex-col h-[50px] justify-between">
					<div class="form-label">Date du souvenir</div>
					<div class="flex justify-start gap-1 form-label">
						entre
						<input id="after-input" type="date" class="filter-input" />
						et
						<input id="before-input" type="date" class="filter-input" />
					</div>
				</div>
				<div id="category-container" class="flex flex gap-1">
					<label for="category-input" class="form-label">Catégorie(s)</label>
					<select multiple name="category-input" id="category-input" class="filter-input" />
					<option value="0"></option>
					<option th:each="category : ${categories}" th:value="${category.categoryId}"
						th:text="${category.name}">
					</option>
					</select>
				</div>
				<div id="my-memories-container" class="flex flex-col gap-1">
					<div>
						<label for="my-memories" class="form-label">Mes souvenirs uniquement</label>
						<input id="my-memories" type="checkbox" name="my-memories" class="ml-3 accent-[#7e9076]" />
					</div>
					<div id="status-container" class="flex items-start w-full hidden">
						<label for="status" class="w-1/3">État</label>
						<select name="status" id="status" class="filter-input" />
						<option value="1" class="filter-option">tous</option>
						<option value="2" class="filter-option">publiés</option>
						<option value="3" class="filter-option">non publiés</option>
						</select>
					</div>
				</div>
			</div>

		</div>
		<div id="grid-container" class="w-full md:w-4/5">
			<div id="cards-container" class="grid grid-cols-1 md:grid-cols-4 lg:grid-cols-6 gap-3 my-6 w-full">

				<a th:each="view : ${views.content}" th:href="@{${view.canonicalUrl}}" class="border border-black rounded-lg flex flex-col items-center w-full h-[150vw] md:h-[30vw] lg:h-[20vw]
          overflow-hidden duration-200 hover:scale-101" th:object="${view.memory}">

					<div class="relative w-full pb-[100%] border-b">
						<img class="absolute rounded-t-lg w-full h-full object-cover" th:src="${view.memory.mediaUUID != null
                      ? '/uploads/' + view.memory.mediaUUID
                      : '/images/public/memory-placeholder.png'}" th:alt="${view.memory.mediaUUID != null
                      ? 'illustration de ' + view.memory.title
                      : 'souvenir sans illustration'}" loading="lazy" />
					</div>

					<h3 class="h3-title mb-2" th:text="*{title}">
						Titre du souvenir
					</h3>

					<p class="w-full px-1 text-justify" th:text="*{#strings.abbreviate(description, 160)}">
						Description du souvenir
					</p>

				</a>
			</div>
			<div id="pagination-control" class="flex flex-row flex-start flex-wrap gap-1">
			</div>
		</div>
	</main>
	<div th:replace="~{fragments/fragment-footer :: footer}"></div>

	<script src="/js/country.js"></script>
</body>

</html>