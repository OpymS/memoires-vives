<!DOCTYPE html>
<html lang="fr" xmlns:th="http://www.thymeleaf.org">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Inscription - Mémoires vives</title>
	<link rel="stylesheet" th:href="@{/css/style.build.tailwind.css}">
	<link rel="icon" href="/images/public/favicon.png" />
</head>

<body class="min-h-screen flex flex-col">
	<div th:replace="~{fragments/fragment-header :: header}"></div>

	<main class="mt-[80px] w-full flex-grow flex flex-col items-center">
		<h1 class="h1-title">S'inscrire</h1>
		<form th:action="@{/signup}" method="POST" th:object="${user}"
			class="user-create-form w-full max-w-lg flex flex-col" enctype="multipart/form-data" id="formWithImage">
			<div th:replace="~{fragments/errors/fragment-errors-global::frag-errors}"></div>

			<div class="inputs-container">
				<div class="pseudo-input">
					<label for="inputPseudo" class="form-label">pseudo</label>
					<!--					<input id="inputPseudo" th:field="*{pseudo}" type="text" pattern="^\w+$" maxlength="30" required>-->
					<input id="inputPseudo" th:field="*{pseudo}" type="text" class="form-input">
					<div th:replace="~{fragments/errors/fragment-error :: frag-error(pseudo)}"></div>
				</div>
				<div class="email-input">
					<label for="inputEmail" class="form-label">email</label>
					<!--					<input id="inputEmail" th:field="*{email}" type="email" required>-->
					<input id="inputEmail" th:field="*{email}" type="email" class="form-input">
					<div th:replace="~{fragments/errors/fragment-error :: frag-error(email)}"></div>
				</div>
				<div class="password-input">
					<label for="inputPassword" class="form-label">mot de passe</label>
					<div class="relative w-full block">
						<input id="inputPassword" th:field="*{password}" type="password" class="form-input">
						<button type="button"
							class="password-toggle absolute inset-y-0 right-0 flex items-center pr-3 text-gray-500 hover:text-gray-700">&#9215;</button>
					</div>
				</div>
				<div class="confirm-password-input">
					<label for="inputPasswordConfirm" class="form-label">confirmez votre mot de passe</label>
					<div class="relative w-full block">
						<input id="inputPasswordConfirm" th:field="*{passwordConfirm}" type="password"
							class="form-input">
						<button type="button"
							class="password-toggle absolute inset-y-0 right-0 flex items-center pr-3 text-gray-500 hover:text-gray-700">&#9215;</button>
					</div>
					<div th:replace="~{fragments/errors/fragment-error :: frag-error(password)}"></div>
				</div>
				<div class="image-input mt-2 flex flex-col items-start w-auto">
					<label for="imageInput" class="form-label inline-flex items-center gap-2 cursor-pointer">Photo de
						profil
						<img id="image"
							class="rounded-[50%] min-w-[80px] min-h-[80px] w-1/6 h-1/6 max-w-3xs max-h-[256px] border border-[#bddab2] hover:border-[#7e9076]"
							src="" alt="Votre photo…" />
					</label>
					<input id="imageInput" name="image" type="file" accept="image/png, image/jpeg" class="hidden">
				</div>
				<div th:replace="~{fragments/fragment-captcha :: fragment-captcha}"></div>
			</div>

			<div class="buttons-container">
				<button type="submit" class="form-button button create">Créer</button>
				<a th:href="@{/}" class="form-button button cancel">Annuler</a>
			</div>
		</form>

		<div id="upload-status" class="hidden mt-4 p-3 bg-[#7e9076] text-white rounded flex items-center space-x-2">
			<div class="w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"></div>
			<span>Redimensionnement de l'image en cours...</span>
		</div>
	</main>
	<div th:replace="~{fragments/fragment-footer :: footer}"></div>
	<script src="https://cdn.jsdelivr.net/npm/pica@9.0.1/dist/pica.min.js"></script>
	<script src="/js/images.js"></script>
	<script src="/js/password.js"></script>
</body>

</html>